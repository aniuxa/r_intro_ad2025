<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introducción al Análisis Demográfico con R - 4&nbsp; Tasas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./P5.html" rel="next">
<link href="./P3.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./P4.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tasas</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introducción al Análisis Demográfico con R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/aniuxa/r_ad_somede2025" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Introducción-al-Análisis-Demográfico-con-R.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sobre el curso</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">1. Revisión de fuentes de datos demográficos y su importación en R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Evaluación de información y pirámides</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Lexis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P4.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tasas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./P5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Migración y flujos</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#paquetes" id="toc-paquetes" class="nav-link active" data-scroll-target="#paquetes"><span class="header-section-number">4.1</span> Paquetes</a></li>
  <li><a href="#datos" id="toc-datos" class="nav-link" data-scroll-target="#datos"><span class="header-section-number">4.2</span> Datos</a></li>
  <li><a href="#tasas-de-crecimiento" id="toc-tasas-de-crecimiento" class="nav-link" data-scroll-target="#tasas-de-crecimiento"><span class="header-section-number">4.3</span> Tasas de crecimiento</a>
  <ul class="collapse">
  <li><a href="#fechas-censales-y-tasas-de-crecimiento" id="toc-fechas-censales-y-tasas-de-crecimiento" class="nav-link" data-scroll-target="#fechas-censales-y-tasas-de-crecimiento"><span class="header-section-number">4.3.1</span> Fechas censales y tasas de crecimiento</a></li>
  <li><a href="#ritmo" id="toc-ritmo" class="nav-link" data-scroll-target="#ritmo"><span class="header-section-number">4.3.2</span> Ritmo</a></li>
  <li><a href="#crecimiento" id="toc-crecimiento" class="nav-link" data-scroll-target="#crecimiento"><span class="header-section-number">4.3.3</span> Crecimiento</a></li>
  <li><a href="#crecimiento-aritmético" id="toc-crecimiento-aritmético" class="nav-link" data-scroll-target="#crecimiento-aritmético"><span class="header-section-number">4.3.4</span> Crecimiento aritmético</a></li>
  <li><a href="#crecimiento-geométrico" id="toc-crecimiento-geométrico" class="nav-link" data-scroll-target="#crecimiento-geométrico"><span class="header-section-number">4.3.5</span> Crecimiento geométrico</a></li>
  <li><a href="#crecimiento-exponencial" id="toc-crecimiento-exponencial" class="nav-link" data-scroll-target="#crecimiento-exponencial"><span class="header-section-number">4.3.6</span> Crecimiento exponencial</a></li>
  <li><a href="#proyeccion" id="toc-proyeccion" class="nav-link" data-scroll-target="#proyeccion"><span class="header-section-number">4.3.7</span> Proyeccion</a></li>
  <li><a href="#tiempo" id="toc-tiempo" class="nav-link" data-scroll-target="#tiempo"><span class="header-section-number">4.3.8</span> Tiempo</a></li>
  </ul></li>
  <li><a href="#reconstrucción-de-las-tasas-de-fecundidad" id="toc-reconstrucción-de-las-tasas-de-fecundidad" class="nav-link" data-scroll-target="#reconstrucción-de-las-tasas-de-fecundidad"><span class="header-section-number">4.4</span> Reconstrucción de las tasas de fecundidad</a>
  <ul class="collapse">
  <li><a href="#fusionando" id="toc-fusionando" class="nav-link" data-scroll-target="#fusionando"><span class="header-section-number">4.4.1</span> Fusionando</a></li>
  </ul></li>
  <li><a href="#nacimientos" id="toc-nacimientos" class="nav-link" data-scroll-target="#nacimientos"><span class="header-section-number">4.5</span> Nacimientos</a></li>
  <li><a href="#mortalidad" id="toc-mortalidad" class="nav-link" data-scroll-target="#mortalidad"><span class="header-section-number">4.6</span> Mortalidad</a></li>
  <li><a href="#discrepancias" id="toc-discrepancias" class="nav-link" data-scroll-target="#discrepancias"><span class="header-section-number">4.7</span> Discrepancias</a>
  <ul class="collapse">
  <li><a href="#momento-de-práctica-1" id="toc-momento-de-práctica-1" class="nav-link" data-scroll-target="#momento-de-práctica-1"><span class="header-section-number">4.7.1</span> Momento de práctica</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/aniuxa/r_ad_somede2025/edit/main/P4.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/aniuxa/r_ad_somede2025/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tasas</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="paquetes" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="paquetes"><span class="header-section-number">4.1</span> Paquetes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>) <span class="co"># instala pacman si se requiere</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>               readxl, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>               writexl,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>               janitor,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>               remotes,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>               wppExplorer,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>               magrittr,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>               collapse,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>               fmsb,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>               DemoTools, </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>               wpp2024) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="datos" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="datos"><span class="header-section-number">4.2</span> Datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>censos <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"datos/censos.xlsx"</span>, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"numeric"</span>,<span class="st">"date"</span>, <span class="st">"numeric"</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"tfr1dt"</span>) </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"percentASFR1dt"</span>) </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"misc1dt"</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"mx1dt"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"pop1dt"</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"popAge1dt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tasas-de-crecimiento" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="tasas-de-crecimiento"><span class="header-section-number">4.3</span> Tasas de crecimiento</h2>
<section id="fechas-censales-y-tasas-de-crecimiento" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="fechas-censales-y-tasas-de-crecimiento"><span class="header-section-number">4.3.1</span> Fechas censales y tasas de crecimiento</h3>
<p>Un elemento fundamental es encontrar los periodos intercensales en años. Los censos tienen diferentes fechas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>censos <span class="sc">%&lt;&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">dias =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(fecha))) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">n=</span>dias<span class="sc">/</span><span class="dv">365</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>censos  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 5
     ano fecha               poblacion  dias     n
   &lt;dbl&gt; &lt;dttm&gt;                  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  1900 1900-10-28 00:00:00  13607272    NA NA   
 2  1910 1910-10-27 00:00:00  15160369  3651 10.0 
 3  1921 1921-10-20 00:00:00  14334780  4011 11.0 
 4  1930 1930-05-15 00:00:00  16552722  3129  8.57
 5  1940 1940-03-06 00:00:00  19653552  3583  9.82
 6  1950 1950-06-06 00:00:00  25791017  3744 10.3 
 7  1960 1960-06-08 00:00:00  34923129  3655 10.0 
 8  1970 1970-01-28 00:00:00  48225238  3521  9.65
 9  1980 1980-06-04 00:00:00  66846833  3780 10.4 
10  1990 1990-03-12 00:00:00  81249645  3568  9.78
11  2000 2000-02-14 00:00:00  97483412  3626  9.93
12  2010 2010-06-12 00:00:00 112336538  3771 10.3 
13  2020 2020-03-15 00:00:00 126014024  3564  9.76</code></pre>
</div>
</div>
<p>Con esta base ya podemos ir calculando diferentes tipos de crecimiento básicos.</p>
</section>
<section id="ritmo" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="ritmo"><span class="header-section-number">4.3.2</span> Ritmo</h3>
<p><span class="math display">\[ ritmo=\frac{P_{t+n}}{P_t} \]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>censos<span class="ot">&lt;-</span>censos <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">ritmo =</span> poblacion<span class="sc">/</span><span class="fu">lag</span>(poblacion))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>censos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 6
     ano fecha               poblacion  dias     n  ritmo
   &lt;dbl&gt; &lt;dttm&gt;                  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1  1900 1900-10-28 00:00:00  13607272    NA NA    NA    
 2  1910 1910-10-27 00:00:00  15160369  3651 10.0   1.11 
 3  1921 1921-10-20 00:00:00  14334780  4011 11.0   0.946
 4  1930 1930-05-15 00:00:00  16552722  3129  8.57  1.15 
 5  1940 1940-03-06 00:00:00  19653552  3583  9.82  1.19 
 6  1950 1950-06-06 00:00:00  25791017  3744 10.3   1.31 
 7  1960 1960-06-08 00:00:00  34923129  3655 10.0   1.35 
 8  1970 1970-01-28 00:00:00  48225238  3521  9.65  1.38 
 9  1980 1980-06-04 00:00:00  66846833  3780 10.4   1.39 
10  1990 1990-03-12 00:00:00  81249645  3568  9.78  1.22 
11  2000 2000-02-14 00:00:00  97483412  3626  9.93  1.20 
12  2010 2010-06-12 00:00:00 112336538  3771 10.3   1.15 
13  2020 2020-03-15 00:00:00 126014024  3564  9.76  1.12 </code></pre>
</div>
</div>
</section>
<section id="crecimiento" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="crecimiento"><span class="header-section-number">4.3.3</span> Crecimiento</h3>
<p><span class="math display">\[ c=\frac{P_{t+n}-{P_t}}{P_t} =\frac{P_{t+n}}{P_t}-1 \]</span></p>
<p>Básicamente es el ritmo menos 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>censos<span class="ot">&lt;-</span>censos <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">c =</span> ritmo<span class="dv">-1</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>censos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 7
     ano fecha               poblacion  dias     n  ritmo       c
   &lt;dbl&gt; &lt;dttm&gt;                  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
 1  1900 1900-10-28 00:00:00  13607272    NA NA    NA     NA     
 2  1910 1910-10-27 00:00:00  15160369  3651 10.0   1.11   0.114 
 3  1921 1921-10-20 00:00:00  14334780  4011 11.0   0.946 -0.0545
 4  1930 1930-05-15 00:00:00  16552722  3129  8.57  1.15   0.155 
 5  1940 1940-03-06 00:00:00  19653552  3583  9.82  1.19   0.187 
 6  1950 1950-06-06 00:00:00  25791017  3744 10.3   1.31   0.312 
 7  1960 1960-06-08 00:00:00  34923129  3655 10.0   1.35   0.354 
 8  1970 1970-01-28 00:00:00  48225238  3521  9.65  1.38   0.381 
 9  1980 1980-06-04 00:00:00  66846833  3780 10.4   1.39   0.386 
10  1990 1990-03-12 00:00:00  81249645  3568  9.78  1.22   0.215 
11  2000 2000-02-14 00:00:00  97483412  3626  9.93  1.20   0.200 
12  2010 2010-06-12 00:00:00 112336538  3771 10.3   1.15   0.152 
13  2020 2020-03-15 00:00:00 126014024  3564  9.76  1.12   0.122 </code></pre>
</div>
</div>
</section>
<section id="crecimiento-aritmético" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="crecimiento-aritmético"><span class="header-section-number">4.3.4</span> Crecimiento aritmético</h3>
<p><span class="math display">\[ r_a=\frac{P_{t+n}-{P_t}}{n*P_t} =\frac{c}n \]</span> Básicamente es el crecimiento entre el periodo intercensal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>censos<span class="ot">&lt;-</span>censos <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">ra =</span> c<span class="sc">/</span>n)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>censos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 8
     ano fecha               poblacion  dias     n  ritmo       c       ra
   &lt;dbl&gt; &lt;dttm&gt;                  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1  1900 1900-10-28 00:00:00  13607272    NA NA    NA     NA      NA      
 2  1910 1910-10-27 00:00:00  15160369  3651 10.0   1.11   0.114   0.0114 
 3  1921 1921-10-20 00:00:00  14334780  4011 11.0   0.946 -0.0545 -0.00496
 4  1930 1930-05-15 00:00:00  16552722  3129  8.57  1.15   0.155   0.0180 
 5  1940 1940-03-06 00:00:00  19653552  3583  9.82  1.19   0.187   0.0191 
 6  1950 1950-06-06 00:00:00  25791017  3744 10.3   1.31   0.312   0.0304 
 7  1960 1960-06-08 00:00:00  34923129  3655 10.0   1.35   0.354   0.0354 
 8  1970 1970-01-28 00:00:00  48225238  3521  9.65  1.38   0.381   0.0395 
 9  1980 1980-06-04 00:00:00  66846833  3780 10.4   1.39   0.386   0.0373 
10  1990 1990-03-12 00:00:00  81249645  3568  9.78  1.22   0.215   0.0220 
11  2000 2000-02-14 00:00:00  97483412  3626  9.93  1.20   0.200   0.0201 
12  2010 2010-06-12 00:00:00 112336538  3771 10.3   1.15   0.152   0.0147 
13  2020 2020-03-15 00:00:00 126014024  3564  9.76  1.12   0.122   0.0125 </code></pre>
</div>
</div>
</section>
<section id="crecimiento-geométrico" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="crecimiento-geométrico"><span class="header-section-number">4.3.5</span> Crecimiento geométrico</h3>
<p><span class="math display">\[ r_g=\sqrt[n]{\frac{P_{t+n}}{{P_t}}}-1 \]</span></p>
<p>Es la raíz n-ésima del ritmo menos 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>censos<span class="ot">&lt;-</span>censos <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">rg =</span> ritmo<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>n)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>censos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 9
     ano fecha               poblacion  dias     n  ritmo       c       ra
   &lt;dbl&gt; &lt;dttm&gt;                  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1  1900 1900-10-28 00:00:00  13607272    NA NA    NA     NA      NA      
 2  1910 1910-10-27 00:00:00  15160369  3651 10.0   1.11   0.114   0.0114 
 3  1921 1921-10-20 00:00:00  14334780  4011 11.0   0.946 -0.0545 -0.00496
 4  1930 1930-05-15 00:00:00  16552722  3129  8.57  1.15   0.155   0.0180 
 5  1940 1940-03-06 00:00:00  19653552  3583  9.82  1.19   0.187   0.0191 
 6  1950 1950-06-06 00:00:00  25791017  3744 10.3   1.31   0.312   0.0304 
 7  1960 1960-06-08 00:00:00  34923129  3655 10.0   1.35   0.354   0.0354 
 8  1970 1970-01-28 00:00:00  48225238  3521  9.65  1.38   0.381   0.0395 
 9  1980 1980-06-04 00:00:00  66846833  3780 10.4   1.39   0.386   0.0373 
10  1990 1990-03-12 00:00:00  81249645  3568  9.78  1.22   0.215   0.0220 
11  2000 2000-02-14 00:00:00  97483412  3626  9.93  1.20   0.200   0.0201 
12  2010 2010-06-12 00:00:00 112336538  3771 10.3   1.15   0.152   0.0147 
13  2020 2020-03-15 00:00:00 126014024  3564  9.76  1.12   0.122   0.0125 
# ℹ 1 more variable: rg &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="crecimiento-exponencial" class="level3" data-number="4.3.6">
<h3 data-number="4.3.6" class="anchored" data-anchor-id="crecimiento-exponencial"><span class="header-section-number">4.3.6</span> Crecimiento exponencial</h3>
<p><span class="math display">\[ r=\frac{ln\frac{P_{t+n}}{P_t}}{n} \]</span></p>
<p>Básicamente es logaritmo del ritmo entre n</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>censos<span class="ot">&lt;-</span>censos <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">r =</span> <span class="fu">log</span>(ritmo)<span class="sc">/</span>n)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>censos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 10
     ano fecha               poblacion  dias     n  ritmo       c       ra
   &lt;dbl&gt; &lt;dttm&gt;                  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1  1900 1900-10-28 00:00:00  13607272    NA NA    NA     NA      NA      
 2  1910 1910-10-27 00:00:00  15160369  3651 10.0   1.11   0.114   0.0114 
 3  1921 1921-10-20 00:00:00  14334780  4011 11.0   0.946 -0.0545 -0.00496
 4  1930 1930-05-15 00:00:00  16552722  3129  8.57  1.15   0.155   0.0180 
 5  1940 1940-03-06 00:00:00  19653552  3583  9.82  1.19   0.187   0.0191 
 6  1950 1950-06-06 00:00:00  25791017  3744 10.3   1.31   0.312   0.0304 
 7  1960 1960-06-08 00:00:00  34923129  3655 10.0   1.35   0.354   0.0354 
 8  1970 1970-01-28 00:00:00  48225238  3521  9.65  1.38   0.381   0.0395 
 9  1980 1980-06-04 00:00:00  66846833  3780 10.4   1.39   0.386   0.0373 
10  1990 1990-03-12 00:00:00  81249645  3568  9.78  1.22   0.215   0.0220 
11  2000 2000-02-14 00:00:00  97483412  3626  9.93  1.20   0.200   0.0201 
12  2010 2010-06-12 00:00:00 112336538  3771 10.3   1.15   0.152   0.0147 
13  2020 2020-03-15 00:00:00 126014024  3564  9.76  1.12   0.122   0.0125 
# ℹ 2 more variables: rg &lt;dbl&gt;, r &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Este crecimiento es el más utilizado.</p>
<p>Podemos graficar los diferentes crecimientos, será más fácil si cambiamos el formato</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>censos <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(ano, ra, rg, r)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>ano, <span class="at">names_to =</span> <span class="st">"tipo"</span>, <span class="at">values_to =</span> <span class="st">"crecimiento"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 39 × 3
     ano tipo  crecimiento
   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;
 1  1900 ra       NA      
 2  1900 rg       NA      
 3  1900 r        NA      
 4  1910 ra        0.0114 
 5  1910 rg        0.0109 
 6  1910 r         0.0108 
 7  1921 ra       -0.00496
 8  1921 rg       -0.00508
 9  1921 r        -0.00510
10  1930 ra        0.0180 
# ℹ 29 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>censos <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(ano, ra, rg, r)) <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>ano, <span class="at">names_to =</span> <span class="st">"tipo"</span>, <span class="at">values_to =</span> <span class="st">"crecimiento"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ano,crecimiento, <span class="at">group=</span>tipo, <span class="at">color=</span>tipo)) <span class="sc">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="P4_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Con estas tasas de crecimiento también podemos hacer estimaciones de tiempo y de poblaciones en fechas específicas.</p>
</section>
<section id="proyeccion" class="level3" data-number="4.3.7">
<h3 data-number="4.3.7" class="anchored" data-anchor-id="proyeccion"><span class="header-section-number">4.3.7</span> Proyeccion</h3>
<p><span class="math display">\[ P_{t+n}= P_t * e^{nr} \]</span> Vamos a proyectar la población al primero de julio de 2009</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">difftime</span>(<span class="fu">as.Date</span>(<span class="st">"2009-07-1"</span>),</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">as.Date</span>(<span class="fu">paste</span>(censos[censos<span class="sc">$</span>ano<span class="sc">==</span><span class="dv">2000</span>,]<span class="sc">$</span>fecha)))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 3425 days</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(n<span class="sc">/</span><span class="dv">365</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9.383562</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>censos[censos<span class="sc">$</span>ano<span class="sc">==</span><span class="dv">2010</span>, <span class="st">"poblacion"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  poblacion
      &lt;dbl&gt;
1 112336538</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>censos[censos<span class="sc">$</span>ano<span class="sc">==</span><span class="dv">2010</span>, <span class="st">"r"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
       r
   &lt;dbl&gt;
1 0.0137</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ptn<span class="ot">&lt;-</span> censos[censos<span class="sc">$</span>ano<span class="sc">==</span><span class="dv">2010</span>,<span class="st">"poblacion"</span>]<span class="sc">*</span><span class="fu">exp</span>(n<span class="sc">*</span>censos[censos<span class="sc">$</span>ano<span class="sc">==</span><span class="dv">2010</span>, <span class="st">"r"</span>])</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(ptn) <span class="co"># para ver los decimales</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "127779228.863837"</code></pre>
</div>
</div>
<p>Con esto podemos crear una función: [debes tener los datos de censo con las estimaciones de r]</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pob_estim <span class="ot">&lt;-</span> <span class="cf">function</span>(fecha,ano) {</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    n<span class="ot">&lt;-</span><span class="fu">difftime</span>(<span class="fu">as.Date</span>(fecha),</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.Date</span>(<span class="fu">paste</span>(censos[censos<span class="sc">$</span>ano<span class="sc">==</span>ano,]<span class="sc">$</span>fecha)))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    n<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(n<span class="sc">/</span><span class="dv">365</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    ptn<span class="ot">&lt;-</span>censos[censos<span class="sc">$</span>ano<span class="sc">==</span>ano,<span class="st">"poblacion"</span>]<span class="sc">*</span><span class="fu">exp</span>(n<span class="sc">*</span>censos[censos<span class="sc">$</span>ano<span class="sc">==</span>ano, <span class="st">"r"</span>])</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ptn)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pob_estim</span>(<span class="at">fecha =</span><span class="st">"2008-01-07"</span>, </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ano =</span> <span class="dv">2010</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  poblacion
1 108651068</code></pre>
</div>
</div>
</section>
<section id="tiempo" class="level3" data-number="4.3.8">
<h3 data-number="4.3.8" class="anchored" data-anchor-id="tiempo"><span class="header-section-number">4.3.8</span> Tiempo</h3>
<p><span class="math display">\[ n=\frac{ln\frac{P_{t+n}}{{P_t}}}r\]</span></p>
<p>¿Cuánto tiempo tardaría en duplicarse la población del último censo?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>n_calc<span class="ot">&lt;-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>censos[censos<span class="sc">$</span>ano<span class="sc">==</span><span class="dv">2020</span>,<span class="st">"poblacion"</span>]<span class="sc">/</span>censos[censos<span class="sc">$</span>ano<span class="sc">==</span><span class="dv">2020</span>,<span class="st">"poblacion"</span>])<span class="sc">/</span>censos[censos<span class="sc">$</span>ano<span class="sc">==</span><span class="dv">2020</span>,<span class="st">"r"</span>]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>n_calc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  poblacion
1   58.9078</code></pre>
</div>
</div>
<section id="momento-de-práctica" class="level4" data-number="4.3.8.1">
<h4 data-number="4.3.8.1" class="anchored" data-anchor-id="momento-de-práctica"><span class="header-section-number">4.3.8.1</span> Momento de práctica</h4>
<ul>
<li><p>Calcula, si la población creciera cómo lo hizo entre los primeros dos censos, en cuánto tiempo se duplicaría</p></li>
<li><p>Calcula la población al 1 de julio de 1999, puedes usar la función.</p></li>
</ul>
</section>
</section>
</section>
<section id="reconstrucción-de-las-tasas-de-fecundidad" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="reconstrucción-de-las-tasas-de-fecundidad"><span class="header-section-number">4.4</span> Reconstrucción de las tasas de fecundidad</h2>
<p>“tfr1dt” # esta es la base de las tasas de fecundidad “percentASFR1dt” ¿cómo se distrib484e a lo largo de las edades de las mujeres?</p>
<p>La lógica la muestro con un ejemplo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>tfr1dt <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">"World"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">==</span><span class="dv">2000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(tfr) <span class="ot">-&gt;</span> tfr <span class="co"># esto es un escalar</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>hoy queremos el vector de las edades y del porcentaje</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>percentASFR1dt <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">"World"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">==</span><span class="dv">2000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, pasfr) <span class="ot">-&gt;</span> pasfr <span class="co"># esto es un vector ordenado por las edades</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sumamos el vector y nos damos cuenta que no es la <em>age specific fertility rate</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pasfr<span class="sc">$</span>pasfr)<span class="co"># suma el 100%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100</code></pre>
</div>
</div>
<p>Vamos a prorratear la intensidad sobre el calendario :)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>pasfr <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tasa=</span>pasfr<span class="sc">*</span>tfr<span class="sc">$</span>tfr<span class="sc">/</span><span class="dv">100</span><span class="sc">*</span><span class="dv">1000</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(pasfr<span class="sc">$</span>tasa<span class="sc">/</span><span class="dv">1000</span>) <span class="co"># suma la tasa global</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.753664</code></pre>
</div>
</div>
<p>Vamos a graficarla</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>pasfr <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>age,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>tasa) <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="P4_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="fusionando" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="fusionando"><span class="header-section-number">4.4.1</span> Fusionando</h3>
<p>Podemos fusionar ambas tablas para hacer esto para todos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>tasa_fec1dt<span class="ot">&lt;-</span>percentASFR1dt <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(tfr1dt) <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tasa =</span> pasfr <span class="sc">*</span> tfr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(country_code, name, year)`</code></pre>
</div>
</div>
<p>Hoy podemos comparar intensidades y calendarios históricos!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>tasa_fec1dt <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country_code <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">484</span>, <span class="dv">222</span>, <span class="dv">320</span>, <span class="dv">340</span>, <span class="dv">858</span>, <span class="dv">1830</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">==</span><span class="dv">2021</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> tasa,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> name,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> name) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tasas de fecundidad en América Latina"</span>, </span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2020"</span>,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"País"</span>,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Division UNP (2023). _wpp2022: World Population Prospects 2022_. R</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="st">  package version 1.1-4, &lt;http://population.un.org/wpp&gt;.</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="P4_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Hoy comparamos tasas a lo largo del tiempo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>tasa_fec1dt <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country_code<span class="sc">==</span><span class="dv">484</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">%in%</span><span class="fu">seq</span>(<span class="dv">1950</span>,<span class="dv">2020</span>, <span class="at">by=</span><span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> tasa,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="fu">as.factor</span>(year),</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> <span class="fu">as.factor</span>(year)) <span class="sc">+</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tasas de fecundidad en América Latina"</span>, </span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"México"</span>,</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"año"</span>,</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Division UNP (2024). _wpp2024: World Population Prospects 2024_. R package</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="st">  version 1.1-3, commit bac89293562767ff8510144974fd888e25bc7ee7,</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;https://github.com/PPgp/wpp2024&gt;."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="P4_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Un mix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>tasa_fec1dt <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country_code <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">484</span>, <span class="dv">222</span>, <span class="dv">320</span>, <span class="dv">340</span>, <span class="dv">858</span>, <span class="dv">1830</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">%in%</span><span class="fu">seq</span>(<span class="dv">1950</span>,<span class="dv">2020</span>, <span class="at">by=</span><span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> tasa,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="fu">as.factor</span>(year),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> <span class="fu">as.factor</span>(year)) <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tasas de fecundidad en América Latina"</span>, </span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"año"</span>,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Division UNP (2023). _wpp2022: World Population Prospects 2022_. R</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="st">  package version 1.1-4, &lt;http://population.un.org/wpp&gt;.</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>) <span class="sc">+</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="P4_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="nacimientos" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="nacimientos"><span class="header-section-number">4.5</span> Nacimientos</h2>
<p>Es muy útil tener las tasa en edades específicas. Pero si quisiéramos las tasas en edades quinquenales o bien calcular la tasa general de fecundidad, tendríamos que tener la estructura de los nacimientos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(misc1dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">misc1dt</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">21978</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">Key</td>
<td style="text-align: left;">NULL</td>
</tr>
<tr class="odd">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">character</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">name</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">59</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">295</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">country_code</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">703.75</td>
<td style="text-align: right;">823.78</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">275.00</td>
<td style="text-align: right;">554.00</td>
<td style="text-align: right;">831.00</td>
<td style="text-align: right;">5505.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">year</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1986.50</td>
<td style="text-align: right;">21.36</td>
<td style="text-align: right;">1950.00</td>
<td style="text-align: right;">1968.00</td>
<td style="text-align: right;">1986.50</td>
<td style="text-align: right;">2005.00</td>
<td style="text-align: right;">2023.00</td>
<td style="text-align: left;">▇▇▇▇▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">births</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4988.71</td>
<td style="text-align: right;">17524.29</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">13.27</td>
<td style="text-align: right;">145.98</td>
<td style="text-align: right;">843.95</td>
<td style="text-align: right;">146054.88</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">cbr</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">28.84</td>
<td style="text-align: right;">13.13</td>
<td style="text-align: right;">3.52</td>
<td style="text-align: right;">16.93</td>
<td style="text-align: right;">27.80</td>
<td style="text-align: right;">40.94</td>
<td style="text-align: right;">58.63</td>
<td style="text-align: left;">▅▇▆▇▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cdr</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11.18</td>
<td style="text-align: right;">6.03</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">7.19</td>
<td style="text-align: right;">9.55</td>
<td style="text-align: right;">13.41</td>
<td style="text-align: right;">153.96</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">deaths</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1953.68</td>
<td style="text-align: right;">6599.80</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">4.06</td>
<td style="text-align: right;">62.49</td>
<td style="text-align: right;">329.23</td>
<td style="text-align: right;">69728.10</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PopChange</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3009.97</td>
<td style="text-align: right;">10895.21</td>
<td style="text-align: right;">-6048.71</td>
<td style="text-align: right;">3.43</td>
<td style="text-align: right;">73.31</td>
<td style="text-align: right;">494.91</td>
<td style="text-align: right;">93667.18</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">growthrate</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">-71.06</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">1.75</td>
<td style="text-align: right;">2.59</td>
<td style="text-align: right;">37.89</td>
<td style="text-align: left;">▁▁▁▇▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cnmr</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">15.63</td>
<td style="text-align: right;">-709.90</td>
<td style="text-align: right;">-3.46</td>
<td style="text-align: right;">-0.31</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">357.14</td>
<td style="text-align: left;">▁▁▁▇▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">NatChangeRT</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">17.67</td>
<td style="text-align: right;">10.72</td>
<td style="text-align: right;">-105.92</td>
<td style="text-align: right;">9.07</td>
<td style="text-align: right;">19.05</td>
<td style="text-align: right;">26.39</td>
<td style="text-align: right;">43.22</td>
<td style="text-align: left;">▁▁▁▅▇</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>La lógica es fusionar a nuestro archivos de tasas, las poblaciones medias y los nacimientos totales en el año, para reconstruir los numeradores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>tasa_fec1dt <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(popAge1dt) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(misc1dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(country_code, name, year, age)`
Joining with `by = join_by(country_code, name, year)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(tasa_fec1dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,018,115
Columns: 18
$ country_code &lt;int&gt; 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 90…
$ name         &lt;chr&gt; "World", "World", "World", "World", "World", "World", "Wo…
$ year         &lt;int&gt; 1950, 1950, 1950, 1950, 1950, 1950, 1950, 1950, 1950, 195…
$ age          &lt;int&gt; 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 2…
$ pasfr        &lt;dbl&gt; 0.001309, 0.016938, 0.059008, 0.154829, 0.331357, 0.64295…
$ tfr          &lt;dbl&gt; 4.851944, 4.851944, 4.851944, 4.851944, 4.851944, 4.85194…
$ tasa         &lt;dbl&gt; 0.006351195, 0.082182227, 0.286303512, 0.751221638, 1.607…
$ popM         &lt;dbl&gt; 26927.18, 26448.37, 26657.29, 26352.70, 25849.18, 25185.7…
$ popF         &lt;dbl&gt; 25766.62, 25265.96, 25409.33, 25121.90, 24817.44, 24321.5…
$ pop          &lt;dbl&gt; 52693.80, 51714.33, 52066.62, 51474.60, 50666.63, 49507.2…
$ births       &lt;dbl&gt; 91823.94, 91823.94, 91823.94, 91823.94, 91823.94, 91823.9…
$ cbr          &lt;dbl&gt; 36.831, 36.831, 36.831, 36.831, 36.831, 36.831, 36.831, 3…
$ cdr          &lt;dbl&gt; 19.448, 19.448, 19.448, 19.448, 19.448, 19.448, 19.448, 1…
$ deaths       &lt;dbl&gt; 48486.89, 48486.89, 48486.89, 48486.89, 48486.89, 48486.8…
$ PopChange    &lt;dbl&gt; 43337.69, 43337.69, 43337.69, 43337.69, 43337.69, 43337.6…
$ growthrate   &lt;dbl&gt; 1.738, 1.738, 1.738, 1.738, 1.738, 1.738, 1.738, 1.738, 1…
$ cnmr         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ NatChangeRT  &lt;dbl&gt; 17.383, 17.383, 17.383, 17.383, 17.383, 17.383, 17.383, 1…</code></pre>
</div>
</div>
<p>Vamos a reconstruir los numeradores de nacimientos específicos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>tasa_fec1dt <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">birth_age=</span>tfr<span class="sc">*</span>popF)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con esta base ya podemos hacer cálculos quinquenales y demás…</p>
</section>
<section id="mortalidad" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="mortalidad"><span class="header-section-number">4.6</span> Mortalidad</h2>
<p>Podemos hacer algo parecido con la mortalidad, sólo que acá las tasas de mortalidad ya están calculadas de manera específica y se incluyen los datos proyectados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>mx1dt <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,529,547
Columns: 7
$ country_code &lt;int&gt; 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 90…
$ name         &lt;chr&gt; "World", "World", "World", "World", "World", "World", "Wo…
$ year         &lt;int&gt; 1950, 1950, 1950, 1950, 1950, 1950, 1950, 1950, 1950, 195…
$ age          &lt;int&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,…
$ mxM          &lt;dbl&gt; 0.16194393, 0.04901019, 0.02821689, 0.01817772, 0.0126645…
$ mxF          &lt;dbl&gt; 0.14354950, 0.04953383, 0.02897489, 0.01861074, 0.0129510…
$ mxB          &lt;dbl&gt; 0.15293607, 0.04926671, 0.02858799, 0.01838971, 0.0128048…</code></pre>
</div>
</div>
<p>Grafiquemos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>mx1dt <span class="sc">%&gt;%</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country_code <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">484</span>, <span class="dv">222</span>, <span class="dv">320</span>, <span class="dv">340</span>, <span class="dv">858</span>, <span class="dv">1830</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">%in%</span><span class="fu">seq</span>(<span class="dv">1950</span>,<span class="dv">2020</span>, <span class="at">by=</span><span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> age,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> mxB,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="fu">as.factor</span>(year),</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> <span class="fu">as.factor</span>(year)) <span class="sc">+</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans =</span> <span class="st">"log10"</span>) <span class="sc">+</span> <span class="co"># ojo</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tasas de mortalidad en América Latina"</span>, </span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"año"</span>,</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Division UNP (2023). _wpp2022: World Population Prospects 2022_. R</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a><span class="st">  package version 1.1-4, &lt;http://population.un.org/wpp&gt;.</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>) <span class="sc">+</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="P4_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Si queremos reconstruir muertes por años podemos pegar la información de misc1dt y de pop1dt</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>mx1dt <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(misc1dt) <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(popAge1dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(country_code, name, year)`
Joining with `by = join_by(country_code, name, year, age)`</code></pre>
</div>
</div>
<p>Vamos a calcular muertes por edad</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>mx1dt <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">deaths_age=</span>mxB<span class="sc">*</span>pop)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mx1dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   country_code   name  year   age        mxM        mxF        mxB   births
          &lt;int&gt; &lt;char&gt; &lt;int&gt; &lt;int&gt;      &lt;num&gt;      &lt;num&gt;      &lt;num&gt;    &lt;num&gt;
1:          900  World  1950     0 0.16194393 0.14354950 0.15293607 91823.94
2:          900  World  1950     1 0.04901019 0.04953383 0.04926671 91823.94
3:          900  World  1950     2 0.02821689 0.02897489 0.02858799 91823.94
4:          900  World  1950     3 0.01817772 0.01861074 0.01838971 91823.94
5:          900  World  1950     4 0.01266450 0.01295105 0.01280488 91823.94
6:          900  World  1950     5 0.00908561 0.00929513 0.00918820 91823.94
      cbr    cdr   deaths PopChange growthrate  cnmr NatChangeRT     popM
    &lt;num&gt;  &lt;num&gt;    &lt;num&gt;     &lt;num&gt;      &lt;num&gt; &lt;num&gt;       &lt;num&gt;    &lt;num&gt;
1: 36.831 19.448 48486.89  43337.69      1.738     0      17.383 42423.73
2: 36.831 19.448 48486.89  43337.69      1.738     0      17.383 37788.70
3: 36.831 19.448 48486.89  43337.69      1.738     0      17.383 34783.84
4: 36.831 19.448 48486.89  43337.69      1.738     0      17.383 32924.84
5: 36.831 19.448 48486.89  43337.69      1.738     0      17.383 31297.27
6: 36.831 19.448 48486.89  43337.69      1.738     0      17.383 28363.97
       popF      pop deaths_age
      &lt;num&gt;    &lt;num&gt;      &lt;num&gt;
1: 40762.38 83186.11 12722.1563
2: 36312.98 74101.68  3650.7460
3: 33382.79 68166.63  1948.7468
4: 31551.20 64476.04  1185.6957
5: 30028.38 61325.65   785.2676
6: 27249.36 55613.32   510.9863</code></pre>
</div>
</div>
<p>#Estandarización de tasas</p>
<p>Vamos a volver a nuestros grupos quinquenales, dejando la mortalidad infantil aparte:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>est<span class="ot">&lt;-</span>mx1dt <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>age, pop, deaths_age) <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">"Mexico"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">%in%</span><span class="fu">c</span>(<span class="dv">1950</span>,<span class="dv">2020</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eda5=</span><span class="fu">cut</span>(age, <span class="co"># la variable a cortar</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="co"># para dejar la mortalidad infantil</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">110</span>, <span class="co"># El rango válido</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">by=</span><span class="dv">5</span>)), <span class="co"># El ancho del intervalo</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">include.lowest=</span>T, <span class="co"># para que incluya el valor más bajo dentro del intervalo</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">right=</span>F)) <span class="co"># indica si el intervalo irá abierto en la derecha, ponemos un no con "FALSE"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vamos a volverlo quinquenal:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>est <span class="sc">%&lt;&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">group_by</span>(country_code, year, eda5) <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pop=</span><span class="fu">sum</span>(pop), </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">deaths_age=</span><span class="fu">sum</span>(deaths_age)) <span class="sc">%&gt;%</span> </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>age) <span class="sc">%&gt;%</span> </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>est</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 × 6
   country_code name    year   pop deaths_age eda5   
          &lt;int&gt; &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;fct&gt;  
 1          484 Mexico  1950 1209.     214.   [0,1)  
 2          484 Mexico  1950 3998.     118.   [1,5)  
 3          484 Mexico  1950 3970.      21.8  [5,10) 
 4          484 Mexico  1950 3206.       9.75 [10,15)
 5          484 Mexico  1950 2775.      12.6  [15,20)
 6          484 Mexico  1950 2462.      15.3  [20,25)
 7          484 Mexico  1950 2077.      15.8  [25,30)
 8          484 Mexico  1950 1652.      13.2  [30,35)
 9          484 Mexico  1950 1470.      17.3  [35,40)
10          484 Mexico  1950 1296.      15.3  [40,45)
# ℹ 34 more rows</code></pre>
</div>
</div>
<p>Creamos las tasas por grupos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>est <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mx5=</span>deaths_age<span class="sc">/</span>pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Necesitamos “c”, es decir la estructura por edad de la población y de las . En este formato será más facil de calcular:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>est <span class="sc">%&lt;&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>pop<span class="sc">/</span><span class="fu">sum</span>(pop), <span class="at">.by =</span> year) </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>est <span class="sc">%&gt;%</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">suma=</span> <span class="fu">sum</span>(c), <span class="at">.by =</span> year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
   year  suma
  &lt;int&gt; &lt;dbl&gt;
1  1950     1
2  2020     1</code></pre>
</div>
</div>
<p>Si “recordamos”:</p>
<p><span class="math display">\[ TBM= \sum_{n=i}^{\omega}c_i*Mx_i \]</span></p>
<p>La suma de eso será la tasa:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>est <span class="sc">%&gt;%</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summarise</span>(<span class="at">tbm=</span><span class="fu">sum</span>(mx5<span class="sc">*</span>c)<span class="sc">*</span><span class="dv">1000</span>, <span class="at">.by =</span> year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
   year   tbm
  &lt;int&gt; &lt;dbl&gt;
1  1950 21.6 
2  2020  8.46</code></pre>
</div>
</div>
<p>Una estandarización sería usar la “c” de una de las poblaciones, como la de 1950</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>c_1950 <span class="ot">&lt;-</span> est <span class="sc">%&gt;%</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year<span class="sc">==</span><span class="dv">1950</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>year, eda5, c) <span class="sc">%&gt;%</span> </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>year) <span class="sc">%&gt;%</span> </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">c_1950=</span>c)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>est <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(c_1950)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(country_code, name, eda5)`</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>est <span class="sc">%&gt;%</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summarise</span>(<span class="at">tbm=</span><span class="fu">sum</span>(mx5<span class="sc">*</span>c_1950)<span class="sc">*</span><span class="dv">1000</span>, <span class="at">.by =</span> year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
   year   tbm
  &lt;int&gt; &lt;dbl&gt;
1  1950 21.6 
2  2020  4.50</code></pre>
</div>
</div>
<p>Para estandarizar, cambiamos las “c”, normalmente lo que se hace usar una <span class="math inline">\(\bar c\)</span>, con</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>c_mean <span class="ot">&lt;-</span> est <span class="sc">%&gt;%</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country_code<span class="sc">:</span>year, eda5, c) <span class="sc">%&gt;%</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c_mean=</span><span class="fu">mean</span>(c), <span class="at">.by =</span> eda5) <span class="sc">%&gt;%</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(year, c)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>est <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(c_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(country_code, name, eda5)`</code></pre>
</div>
</div>
<p>Vamos a sacar las tasas estandarizadas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>est <span class="sc">%&gt;%</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summarise</span>(<span class="at">tbm=</span><span class="fu">sum</span>(mx5<span class="sc">*</span>c_mean)<span class="sc">*</span><span class="dv">1000</span>, <span class="at">.by =</span> year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
   year   tbm
  &lt;int&gt; &lt;dbl&gt;
1  1950 21.9 
2  2020  6.48</code></pre>
</div>
</div>
<p>¡Es muy importante estandarizar!</p>
</section>
<section id="discrepancias" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="discrepancias"><span class="header-section-number">4.7</span> Discrepancias</h2>
<p>¿Qué parte de la diferencia de las tasas se debe al cambio etario y cuál al cambio de los riesgos de morir? Siguiendo a Kitagawa en Partida(2013), tenemos:</p>
<p><span class="math display">\[ d^{2020}-d^{1950}= \sum_{n=i}^{\omega}(c_i^{2020}-c_i^{1950})\frac{(Mx_i^{2020}+Mx_i^{1950})}2 + \sum_{n=i}^{\omega}(Mx_i^{2020}-Mx_i^{1950})\frac{(c_i^{2020}+c_i^{1950})}2  \]</span></p>
<blockquote class="blockquote">
<p>El primer sumando en el lado derecho, esto es, la diferencia de las estructuras etarias ponderada por el promedio de las tasas específicas, mide el efecto de la disimiltud en las composiciones por edad; y el segundo, la diferencia de las pautas etarias de las tasas específicas ponderada por el promedio de las composiciones por edad de la población, da cuenta de la diferencia en el riesgo medio de morir (Partida,2013:p.63).</p>
</blockquote>
<p>Para esto sería más fácil tener nuestro formato wide</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>est_wide<span class="ot">&lt;-</span>est<span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>c_1950 ) <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> year,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> pop<span class="sc">:</span>c,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_vary =</span> <span class="st">"slowest"</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Caculemos el primer elemento</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>est_wide <span class="sc">%&gt;%</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">e1=</span><span class="fu">sum</span>((c_2020<span class="sc">-</span>c_1950)    <span class="sc">*</span> (mx5_2020 <span class="sc">+</span>mx5_1950)<span class="sc">/</span><span class="dv">2</span>), </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">e2=</span><span class="fu">sum</span>((mx5_2020<span class="sc">-</span>mx5_1950) <span class="sc">*</span>(c_2020 <span class="sc">+</span>c_1950)<span class="sc">/</span><span class="dv">2</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
       e1      e2
    &lt;dbl&gt;   &lt;dbl&gt;
1 0.00227 -0.0154</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>est <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summarise</span>(<span class="at">tbm=</span><span class="fu">sum</span>(mx5<span class="sc">*</span>c), <span class="at">.by =</span> year) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
   year     tbm
  &lt;int&gt;   &lt;dbl&gt;
1  1950 0.0216 
2  2020 0.00846</code></pre>
</div>
</div>
<section id="momento-de-práctica-1" class="level3" data-number="4.7.1">
<h3 data-number="4.7.1" class="anchored" data-anchor-id="momento-de-práctica-1"><span class="header-section-number">4.7.1</span> Momento de práctica</h3>
<p>Compara las tasas brutas de mortalidad de 1990 con respecto a 2000</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./P3.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Lexis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./P5.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Migración y flujos</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>